#!/usr/bin/env python3

#USAGE jarvis-scp [source] [destination] [host-id]

from jarvis_cd.comm.ssh_config import SSHConfig
from jarvis_cd.comm.scp_node import SCPNode
import sys,os

if __name__ == '__main__':
    conf = SSHConfig().LoadConfig()
    host_id = 0
    source = None
    destination=None
    if len(sys.argv) >= 3:
        source = sys.argv[1]
        destination = sys.argv[2]
    if len(sys.argv) == 4:
        host_id = int(sys.argv[3])
    if len(sys.argv) > 4:
        print("USAGE: jarvis-scp [source] [destination] [host-id]")
        exit(1)
    if conf.all_hosts is None:
        print("Hostfile undefined in jarvis_conf.yaml")
        exit(1)
    SCPNode(source, destination, hosts=conf.all_hosts[host_id], ssh_info=conf.ssh_info).Run()